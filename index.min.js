const themeChangerBtns=document.querySelectorAll(".calculator__theme-btn"),html=document.documentElement,warningMessageBox=document.querySelector(".calculator__warning-message"),allButtons=document.querySelectorAll("button"),digits=document.querySelectorAll(".calculator__operand-btn"),dotBtn=document.querySelector(".calculator__dot-btn");let operation=[],isAdded=!1;const currentOperatation=document.querySelector(".calculator__current-operator"),currentOperand=document.querySelector(".calculator__current-operand"),clearScreenBtns={clearBtn:document.querySelector(".calculator__clear-btn"),backspaceBtn:document.querySelector(".calculator__erase-btn")},operators={moduloBtn:document.querySelector(".calculator__modulo-btn"),mutliplyBtn:document.querySelector(".calculator__multiply-btn"),divideBtn:document.querySelector(".calculator__divide-btn"),addBtn:document.querySelector(".calculator__add-btn"),substractBtn:document.querySelector(".calculator__substract-btn"),equalBtn:document.querySelector(".calculator__calculate-btn")},disableAllOtherButtons=()=>{allButtons.forEach(e=>{e.disabled=!0})},enableAllOtherButtons=()=>{allButtons.forEach(e=>{e.disabled=!1})},resetResults=()=>{currentOperand.textContent="",currentOperatation.textContent="",operation=[]},isBothNumbersAreFloats=(e,t)=>!Number.isInteger(e)&&!Number.isInteger(t),displayWarningMessage=(e,t)=>{console.log(warningMessageBox,"warning message"),warningMessageBox.style="transform: translate3d(0,0,0)",warningMessageBox.textContent=`${e} ${t}`,disableAllOtherButtons(),setTimeout(()=>{warningMessageBox.style="transform: translate3d(300%,0,0)",enableAllOtherButtons(),currentOperand.textContent="",currentOperatation.textContent="",operation=[]},4500)},add=(e,t)=>isBothNumbersAreFloats(e,t)?(10*e+10*t)/10:e+t,substract=(e,t)=>isBothNumbersAreFloats(e,t)?(10*e-10*t)/10:e-t,divide=(e,t)=>(console.log(isBothNumbersAreFloats(e,t),e,t,e*t,10*e*t*10/10,"hhhheeerre"),isBothNumbersAreFloats(e)?(displayWarningMessage(e,"can't be divied by 0"),"INVALID"):e/t),mutliply=(e,t)=>isBothNumbersAreFloats(e,t)?10*e*t*10/10:e*t,modulo=(e,t)=>0==e&&0==t||0==t?(displayWarningMessage(e,"can't be modulod by 0"),"INVALID"):e%t,operate=(e,t,r)=>{t=Number(t),r=Number(r);let n=0;switch(e){case"+":n=add(t,r);break;case"-":n=substract(t,r);break;case"*":n=mutliply(t,r);break;case"/":n=divide(t,r);break;case"%":n=modulo(t,r)}return n},removeActiveClass=()=>{themeChangerBtns.forEach(e=>{e.classList.remove("active")})},removeModeType=e=>{e.target.parentElement.classList.contains("calculator__day-mode")?html.classList.remove("night-mode"):html.classList.add("night-mode")},changeTheme=e=>{e.target.parentElement.classList.contains("active")||(themeChangerBtns.forEach(e=>{e.classList.remove("active")}),removeModeType(e),e.target.parentElement.classList.add("active"))},clearScreen=e=>{"keyup"===e.type&&"c"===e.key?(currentOperatation.textContent="",currentOperand.textContent="",operation=[]):"click"===e.type&&(currentOperatation.textContent="",currentOperand.textContent="",operation=[])},removeLastCharacter=e=>{const t=e.split("");return t.pop(),t.join("")},eraseCurrentCharacter=e=>{("keyup"===e.type&&"Backspace"===e.key||"click"===e.type&&"x"===e.target.dataset.erase)&&(currentOperand.textContent=removeLastCharacter(currentOperand.textContent.trim()),operation.length<=1?operation[0]=removeLastCharacter(operation[0]):operation[2]=removeLastCharacter(operation[2]))},clearOperationArray=()=>{operation=[]},updateScreenWithOperationResult=(e,t)=>{currentOperatation.textContent=e,currentOperand.textContent=e,currentOperatation.textContent+=t},updateOperationArray=e=>{operation[0]=currentOperand.textContent.trim(),operation[1]=e},addNumbers=e=>{if("keyup"===e.type&&"+"===e.key||"click"===e.type&&"+"===e.target.dataset.add)if(0===operation.length)currentOperatation.textContent="0 +",operation[0]="0",operation[1]="+";else if(1===operation.length||2===operation.length)currentOperatation.textContent=`${operation[0]} +`,operation[1]="+";else if(3===operation.length){const e=operate(operation[1],operation[0],operation[2]);updateScreenWithOperationResult(e,"+"),clearOperationArray(),updateOperationArray("+"),isAdded=!0}},trimCurrentOperand=()=>currentOperand.textContent.trim(),updateOperand=e=>{currentOperand.textContent.trim().length>=15||(currentOperand.textContent+="keyup"===e.type?e.key:e.target.dataset.operand)},populateArray=e=>{operation.length<=1?(updateOperand(e),operation[0]=trimCurrentOperand()):2===operation.length?(currentOperand.textContent="keyup"===e.type?e.key:e.target.dataset.operand,operation[2]=trimCurrentOperand()):isAdded?(updateOperand(e),operation[2]=trimCurrentOperand(),isAdded=!1):(updateOperand(e),operation[2]=trimCurrentOperand())},populateDigit=e=>{("keyup"===e.type&&e.key.match(/[0-9]/)||"click"===e.type&&e.target.dataset.operand.match(/[0-9]/))&&populateArray(e)},substractNumbers=e=>{if("keyup"===e.type&&"-"===e.key||"click"===e.type&&"-"===e.target.dataset.substract)if(0===operation.length)currentOperatation.textContent="0 -",operation[0]="0",operation[1]="-";else if(1===operation.length||2===operation.length)currentOperatation.textContent=`${operation[0]} -`,operation[1]="-";else if(3===operation.length){const e=operate(operation[1],operation[0],operation[2]);updateScreenWithOperationResult(e,"-"),clearOperationArray(),updateOperationArray("-")}},divideNumbers=e=>{if("keyup"===e.type&&"/"===e.key||"click"===e.type&&"/"===e.target.dataset.divide)if(0===operation.length)currentOperatation.textContent="0 /",operation[0]="0",operation[1]="/";else if(1===operation.length||2===operation.length)currentOperatation.textContent=`${operation[0]} /`,operation[1]="/";else if(3===operation.length){const e=operate(operation[1],operation[0],operation[2]);"INVALID"!==e&&(updateScreenWithOperationResult(e,"/"),clearOperationArray(),updateOperationArray("/"))}},moduloNumbers=e=>{if("keyup"===e.type&&"%"===e.key||"click"===e.type&&"%"===e.target.dataset.modulo)if(0===operation.length)currentOperatation.textContent="0 %",operation[0]="0",operation[1]="%";else if(1===operation.length||2===operation.length)currentOperatation.textContent=`${operation[0]} %`,operation[1]="%";else if(3===operation.length){const e=operate(operation[1],operation[0],operation[2]);"INVALID"!==e&&(updateScreenWithOperationResult(e,"%"),clearOperationArray(),updateOperationArray("%"))}},mutliplyNumbers=e=>{if("keyup"===e.type&&"*"===e.key||"click"===e.type&&"*"===e.target.dataset.multiply)if(0===operation.length)currentOperatation.textContent="0 *",operation[0]="0",operation[1]="*";else if(1===operation.length||2===operation.length)currentOperatation.textContent=`${operation[0]} *`,operation[1]="*";else if(3===operation.length){const e=operate(operation[1],operation[0],operation[2]);updateScreenWithOperationResult(e,"*"),clearOperationArray(),updateOperationArray("*")}},calculate=e=>{if("keyup"===e.type&&("="===e.key||"Enter"===e.key)||"click"===e.type&&"="===e.target.dataset.calculate)if(3!==operation.length)warningMessageBox.style="transform:translate3d(0,0,0)",warningMessageBox.textContent="You can't calculate with single operand and operator",disableAllOtherButtons(),setTimeout(()=>{warningMessageBox.style="transform:translate3d(300%,0,0)",enableAllOtherButtons()},3e3);else if(operation.length){const e=operation[1],t=operate(operation[1],operation[0],operation[2]);updateScreenWithOperationResult(t,e),clearOperationArray(),updateOperationArray(e)}},addFloatingPointNumbers=e=>{("keyup"===e.type&&"."===e.key||"click"===e.type&&"."===e.target.dataset.dot)&&(1===operation.length?operation[0].includes(".")||(currentOperand.textContent+=".",operation[0]=operation[0]+"."):3===operation.length&&(operation[2].includes(".")||(currentOperand.textContent+=".",operation[2]=operation[2]+".")))};themeChangerBtns.forEach(e=>e.addEventListener("click",changeTheme)),clearScreenBtns.clearBtn.addEventListener("click",clearScreen),window.addEventListener("keyup",clearScreen),clearScreenBtns.backspaceBtn.addEventListener("click",eraseCurrentCharacter),window.addEventListener("keyup",eraseCurrentCharacter),operators.addBtn.addEventListener("click",addNumbers),window.addEventListener("keyup",addNumbers),operators.substractBtn.addEventListener("click",substractNumbers),window.addEventListener("keyup",substractNumbers),operators.divideBtn.addEventListener("click",divideNumbers),window.addEventListener("keyup",divideNumbers),operators.moduloBtn.addEventListener("click",moduloNumbers),window.addEventListener("keyup",moduloNumbers),operators.mutliplyBtn.addEventListener("click",mutliplyNumbers),window.addEventListener("keyup",mutliplyNumbers),operators.equalBtn.addEventListener("click",calculate),window.addEventListener("keyup",calculate),dotBtn.addEventListener("click",addFloatingPointNumbers),window.addEventListener("keyup",addFloatingPointNumbers),digits.forEach(e=>{e.addEventListener("click",populateDigit),window.addEventListener("keyup",populateDigit)});